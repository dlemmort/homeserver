services:
  homeassistant:
    container_name: homeassistant
    image: 'ghcr.io/home-assistant/home-assistant:${HOME_ASSISTANT_IMAGE_VERSION:-stable}'
    # devices:
    # - '/dev/ttyUSB0:/dev/ttyUSB0'
    ports:
      - ${HOMEASSISTANT_PORT}:8123
    environment:
      GUID: 1000
      PUID: 1000
    healthcheck:
      test: ['CMD', 'curl', '0.0.0.0:8123']
    networks:
      - 'home' 
    #privileged: true
    restart: always
    volumes:
      - './config:/config'
      - '/etc/localtime:/etc/localtime:ro'

  esphome:
    container_name: esphome
    image: esphome/esphome
    volumes:
      - ./esphome/config:/config
      - /etc/localtime:/etc/localtime:ro
    restart: unless-stopped
    ports:
      - ${ESPHOME_PORT}:6052
    networks:
      - 'home' 

  node-red:
    image: nodered/node-red:latest
    container_name: node-red
    environment:
      - TZ=${TZ}
    ports:
      - "1880:1880"
    volumes:
      - ./nodered:/data